# JADERを用いたTNF-α阻害薬による有害事象数を使用したRORの算出

## 実行環境

### ブラウザ

- Colaboratory *1

*1 [Colaboratory](https://colab.research.google.com/notebooks/welcome.ipynb?hl=ja#scrollTo=5fCEDCU_qrC0)とは、ブラウザ上でPythonを記述、実行できる環境を提供してくれるサービス。

### ローカル

- Docker  19.03.12
- docker-compose 1.27.2
- jupyter 1.0.0

    その他のライブラリは`docker/requirement.txt`を参照

## フォルダ構造

```

```

## 概要

以下の論文を参考に、TNF-α阻害薬に分類される5剤（インフリキシマブ、エタネルセプト、アダリズマブ、ゴリズマブ、セルトリズマブ ぺゴル）に関連する有害事象が発生した症例の患者情報と頻度の集計、RORを算出する。

[Comparison of Adverse Event Profiles of Tumor Necrosis Factor-Alfa Inhibitors: Analysis of a Spontaneous Reporting Database](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7439489/)

## 手順

有害事象数の集計は<u>コンビネーションカウント（発現日を考慮しない場合</u>）を使用し、<u>各症例別（識別番号）に薬の種類＊有害事象の種類</u>で集計を行う。
※ コンビネーションカウント（発現日を考慮しない場合）については項目「集計方法について」を参照
※ 集計方法の選定理由は項目「集計方法の選定理由」を参照

- 使用するテーブル：症例一覧テーブル、医薬品情報テーブル、副作用情報テーブル

- 各テーブルの重複を削除する

- TNF-α阻害薬に分類される5剤（インフリキシマブ、エタネルセプト、アダリズマブ、ゴリズマブ、セルトリズマブ ぺゴル）に対応する医薬品名を医薬品情報テーブルから検索し、各薬物ごとに変数を追加してフラグをつける。

- 各症例に対する薬の種類を確認するため、識別番号と医薬品（一般名）と追加したTNF -α阻害薬で重複を削除する
    （識別番号ごとの同じ種類の薬物が1つになるようにする）

    ![single_count](https://czeek.com/wp-content/uploads/2018/12/combi-1-768x373.png)

    > 参考：[③副作用数（コンビネーション）](https://czeek.com/jissen/howtocount/)
    > 結合のイメージ図

- 症例ごとの患者情報や報告年度を確認するため、加工した症例一覧テーブルと医薬品情報テーブルを識別番号で結合する。
- 副作用情報テーブルにて<u>各症例ごとの有害事象の種類</u>を集計するために、識別番号と有害事象で重複を削除する
    （識別番号ごとの同じ有害事象が1つになるようにする）
- 加工した症例一覧テーブルと医薬品情報テーブルを識別番号で結合したテーブルと、加工した副作用情報テーブルを結合する。完成したテーブル**jader.csv**を使い集計を行う。 <- 現状はここまで！！！

## 参考

## JADERについて

### JADER（Japanese Adverse Drug Event Report database）とは

独立行政法人医薬品医療機器総合機構（PMDA）が提供している「副作用が疑われる症例報告に関する情報『医薬品副作用データベース』」のこと。以下の4つのテーブルからなる。

 ![jader](https://czeek.com/wp-content/uploads/2017/08/ERJADER.png)

> [くすりの有害事象と薬剤疫学](https://czeek.com/) DB構造について　JADER版

## 集計方法について

下記分割表をイメージしてそれぞれのセルの値を求めてから計算する。

![count](https://czeek.com/wp-content/uploads/2018/12/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88-2018-12-05-11.53.26-768x197.png)

カウントとは、「注目する薬剤と同時に報告されている有害事象の数を計測すること」です。
その薬剤が報告されている症例レポートのうち、有害事象報告欄に記載の内容をチェックして注目する有害事象を数えます。
全症例レポートを対象としてそのカウントを行い、上図の2*2の分割表に集約します。

その集計方法は以下の3つがある

- 症状レポート数
- 有害事象数（シングルカウント）
- 有害事象数（コンビネーションカウント）
    - 発現日を考慮しない場合
    - 発現日を考慮した場合

詳細は[カウント方法について（オーダー機能）](https://czeek.com/jissen/howtocount/)を参照

## JADERの問題点

### 一行に重複して入力されているデータが存在する

例.　TNF-α阻害薬の使用理由

| 使用理由 | per_total | 使用理由 |
| -----------------------------------------------------------: | ---- | -------- |
| 関節リウマチ(関節リウマチ);ベーチェット症候群(ベーチェット病による難治性網膜ぶどう膜炎);ベーチェット症候群(腸管型ベーチェット病);ベーチェット症候群(神経型ベーチェット病) | 1    | 0.006664 |
|                                      関節リウマチ;器質化肺炎 | 1    | 0.006664 |
|                    ぶどう膜炎(左ブドウ膜炎);眼の障害(眼病変) | 1 | 0.006664 |

1つのセルに複数データが入っているものはセミコロンで区切られている。1つの薬物に対して複数の使用理由が書かれているケースやその逆など1体1で対応していないため、他の行と整合性を保ちつつデータを1行ずつにバラすことが困難。

2016年3月31日年あたりに国際標準であるICHガイドライン「個別症例安全性報告を伝送するためのデータ項目」が新しい方式E2B(R3)なったこともあり、項目や記載内容の混在が見られるようになったとのこと。
[PMDA　副作用等の報告に関する情報](https://www.pmda.go.jp/safety/reports/mah/0007.html)

入力の重複に関しては最近も増えている傾向にはあるものの、割と幅広い期間で見受けられる。

https://docs.google.com/spreadsheets/d/1j0SfnBoGhGi7feDviVHf0lL0l-pdFTRUjpKO4Hl71MA/edit?usp=sharing

### 有害事象名や医薬品一般名の用語が統一されていない

1つの薬剤を示している医薬品一般名は英語半角表記、英語全角表記、カタカナなど複数あり、統一して集計することが難しい。医薬品一般名と化合物名を対応させるマスターデータの作成は、種類が9000以上あるため現実的ではない。

TNF-a阻害薬該当の5剤は該当の薬剤を目視で確認し、対応させた。
https://docs.google.com/spreadsheets/d/1h7n75bqZWZrkftSKiSXEdUoBy9ohI6knKMON91US-1c/edit?usp=sharing

### 日付のフォーマットが統一されていない

以下はその一例

```csv
2006
200007
20031016
201804302200
;;;
20090525;20091228;20101115;20110307;20110801;20120227;不明;不明;不明
```

分割投与のため、同じ日付が記入されておりも存在する。これらのフォーマットを揃える必要がある。

### 集計方法の選定理由

この論文ではおそらく<u>発現日を考慮した場合の有害事象数（コンビネーションカウント）</u>を使っていると思われる。

TNF-α阻害薬に関連した有害事象の患者背景（性別や年齢）の合計「Table 2」、薬物の使用理由の集計数「Table 2」、TNF-α阻害薬に関する有害事象の年度別集計の数「Table 1」が同じである。、これは薬物の使用理由は各行の服用した医薬品名＋投与日に紐づいているので、医薬品を種類としてカウントせずにひとつひとつ別で集計している可能性が高い。試しに集計した結果、論文の集計結果と誤差+5-10％程度の近しい値が算出できた。

ただし、<u>発現日を考慮した場合の有害事象数（コンビネーションカウント）</u>では集計が難しい。理由は2つ。

- RORを集計する際には<u>特定の薬物を服用せずに有害事象を発生していない</u>分母の数が必要だが、データ量が多すぎてPCのスペック上集計しきれない。
- 発現日を考慮するためには、上記の項目JADERの問題点の「一行に重複して入力されているデータが存在する」や「日付のフォーマットが統一されていない」の課題を解決しなければならない。特に「一行に重複して入力されているデータが存在する」は異形に分解する処理を実装しようとしたが、量が厳しい上に他のデータとの整合性を担保できないと判断した。

なので論文と集計方法は異なるが、今回は<u>有害事象の発生件数を「薬剤の種類数＊有害事象の報告数」分だけカウントする手法</u>で集計を行う。